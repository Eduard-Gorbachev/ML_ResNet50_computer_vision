# ML_ResNet50_computer_vision

## Описание проекта: Определение возраста покупателей

Сетевой супермаркет «Хлеб-Соль» внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:

Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
Контролировать добросовестность кассиров при продаже алкоголя.

#### В работе используются следующие модели:


  
## Цель исследования:

- Построить и обучить свёрточную нейронную сеть на датасете с фотографиями людей, которая по фотографии определит приблизительный возраст человека. 
- Значения метрки `MAE` на тестовой выборке не больше 8.

## Как запустить проект

- Открыть файл `ML_ResNet50_computer_vision` в GitHub
  
## Краткие результаты

1. Для подготовки данных мы использовали класс `ImageDataGenerator`
2. Для обучения мы выбрали модель `ResNet50` со следующими параметрами:

    - Ининциализировали веса модели из датасета ImageNet — это помогло улучшить качество модели, чем если обучать с нуля;
    - Добавили самостоятельно полносвязный слой с одним нейроном и функцией активации `relu`, так как нам нужен только один нейрон, который вернет предсказание возраста, а функция активации ReLU положительные   прогнозы сети не меняет, а все отрицательные — приводит к нулю. Возраст людей меньше нуля быть не может.
    - Применили алгоритм `Adam`, для автоматического подбора шага при обучении модели. Уменьшили шаг обучения до `0.0001`, что несколько замедляет скорость обучения, но при этом увеличивает качество модели. 
    - Добавили обратные вызовы для более стабильного обучения модели:
        - сохранение весов модели, когда метрика `val_mae` достигает наилучшего значения;
        - раннюю остановку обучения, если метрика `val_mae` не улучшается 3 эпохи подряд;
        - уменьшение шага learning rate, если метрика `val_mae` не улучшается 2 эпохи подряд.
          
3. Все вышеуказанные параметры позволили получить нам метрику `MAE 5.6340`  на тестовой выборке.
